var socket = io();

window.onload = function() {
    'use strict';
    
    // All frames
    var frames = document.querySelectorAll('.frame-block');
    
    // Switch to frame function
    function switchToFrame(id) {
        // Hide all frames
        for(var i = 0; i < frames.length; i++) {
            frames[i].style.display = 'none';
        }

        // Show requested frame
        frames[id].style.display = 'block';
    };
    
    // Frame lookup object
    var frame = {
        'home': 0,
        'host': 1,
        'join': 2,
        'dc'  : 3,
        'game': 4
    };
    
    // Buttons list
    var button = {
        'frameHomeHost'  : document.getElementById('frameHomeHost'),
        'frameHomeJoin'  : document.getElementById('frameHomeJoin'),
        'frameJoinEnter' : document.getElementById('frameJoinEnter')
    };
    
    ///////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////
    //////
    //////
    //////      Frame Home Events
    //////
    //////
    ///////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////
    button.frameHomeHost.onclick = function() {
        // Generate code
        var code = randomCode(8, '#aA');
        
        // Place game code on the second frame
        document.getElementById('frameHostCode').innerHTML = code;
        
        // Emit to app.js
        socket.emit('joinRoom', code);
        
        // Switch to host frame
        switchToFrame(frame.host);
    };
    
    button.frameHomeJoin.onclick = function() {
        // Switch to join frame
        switchToFrame(frame.join);
    };
    
    ///////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////
    //////
    //////
    //////      Frame Host Events
    //////
    //////
    ///////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////
    
    // N/A
    
    ///////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////
    //////
    //////
    //////      Frame Join Events
    //////
    //////
    ///////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////
    
    // TODO: Submit game code and redirect to Game frame if correct
    button.frameJoinEnter.onclick = function() {
        // Get the code from the input field
        var code = document.getElementById('frameJoinCode').value;
        
        if (code.length == 0) {
            alert('Please enter code');
            
            return;
        }
        
        // Emit to app.js
        socket.emit('joinRoom', code);
    };
    
    ///////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////
    //////
    //////
    //////      Both Players Joined Event
    //////
    //////
    ///////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////
    
    socket.on('roomReady', function() {
        // Both players joined, switch to game frame
        switchToFrame(frame.game);
    });
    
    ///////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////
    //////
    //////
    //////      One Player Disconnected
    //////
    //////
    ///////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////
    
    socket.on('opponentDisconnected', function() {
        // TODO: Stop the game
        
        // Leave room
        socket.emit('leaveRoom');
        
        // Switch to disconnected frame
        switchToFrame(frame.dc);
    });
    
    ///////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////
    //////
    //////
    //////      Frame Game Events
    //////
    //////
    ///////////////////////////////////////////////////////////////////
    ///////////////////////////////////////////////////////////////////
    
    // TODO: Frame game events
};